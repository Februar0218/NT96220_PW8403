#include "debug.h"
#include "sensor.h"
#include "string.h"

#if MI9130_220

const UINT32 VDOZOOM_INFOR_MODE_1_TABLE[61][6] =
{
    //sie_in        pre_out
    {624,  468,  624,  468,  624,  468},
    {608,  452,  608,  452,  604,  452},
    {592,  436,  592,  436,  584,  436},
    {576,  420,  576,  420,  564,  420},
    {544,  408,  544,  408,  544,  408},
    {528,  392,  528,  392,  524,  392},
    {512,  380,  512,  380,  508,  380},
    {496,  368,  496,  368,  488,  368},
    {480,  356,  480,  356,  472,  356},
    {464,  344,  464,  344,  456,  344},
    {448,  332,  448,  332,  440,  332},
    {432,  320,  432,  320,  428,  320},
    {416,  308,  416,  308,  412,  308},
    {400,  300,  400,  300,  396,  300},
    {384,  288,  384,  288,  384,  288},
    {384,  280,  384,  280,  372,  280},
    {368,  268,  368,  268,  360,  268},
    {352,  260,  352,  260,  348,  260},
    {336,  252,  336,  252,  336,  252},
    {336,  244,  336,  244,  324,  244},
    {320,  236,  320,  236,  312,  236},
    {304,  228,  304,  228,  300,  228},
    {304,  220,  304,  220,  292,  220},
    {288,  212,  288,  212,  280,  212},
    {272,  204,  272,  204,  272,  204},
    {272,  196,  272,  196,  264,  196},
    {256,  192,  256,  192,  252,  192},
    {256,  184,  256,  184,  244,  184},
    {240,  176,  240,  176,  236,  176},
    {240,  172,  240,  172,  228,  172},
    {224,  164,  224,  164,  220,  164},
    {224,  160,  224,  160,  212,  160},
    {208,  156,  208,  156,  204,  156},
    {208,  148,  208,  148,  200,  148},
    {192,  144,  192,  144,  192,  144},
    {192,  140,  192,  140,  184,  140},
    {192,  136,  192,  136,  180,  136},
    {176,  128,  176,  128,  172,  128},
    {176,  124,  176,  124,  168,  124},
    {160,  120,  160,  120,  160,  120},
    {160,  116,  160,  116,  156,  116},
    {160,  112,  160,  112,  152,  112},
    {144,  108,  144,  108,  144,  108},
    {144,  104,  144,  104,  140,  104},
    {144,  100,  144,  100,  136,  100},
    {144,  100,  144,  100,  132,  100},
    {128,  96,   128,  96,   128,  96},
    {128,  92 ,  128,  92 ,  124,  92 },
    {128,  88 ,  128,  88 ,  120,  88 },
    {128,  84 ,  128,  84 ,  116,  84 },
    {112,  84,   112,  84,   112,  84},
    {112,  80,   112,  80,   108,  80},
    {112,  76 ,  112,  76 ,  104,  76 },
    {112,  76,   112,  76,   100,  76},
    {96,   72,   96,   72,   96,   72},
    {96,   68,   96,   68,   92,   68},
    {96,   68,   96,   68,   88,   68},
    {96 ,  64 ,  96 ,  64 ,  88 ,  64 },
    {96,   64,   96,   64,   84,   64},
    {80 ,  60 ,  80 ,  60 ,  80 ,  60 },
    {80,   60,   80,   60,   80,   60},
};

const UINT32 VDOZOOM_INFOR_MODE_2_TABLE[61][6] =
{
    //sie_in        pre_out
    {944,    708,    944,    708,    944,    708},
    {912,    684,    912,    684,    912,    684},
    {880,    660,    880,    660,    880,    660},
    {864,    640,    864,    640,    852,    640},
    {832,    616,    832,    616,    820,    616},
    {800,    596,    800,    596,    792,    596},
    {768,    576,    768,    576,    768,    576},
    {752,    556,    752,    556,    740,    556},
    {720,    536,    720,    536,    716,    536},
    {704,    520,    704,    520,    692,    520},
    {672,    500,    672,    500,    668,    500},
    {656,    484,    656,    484,    644,    484},
    {624,    468,    624,    468,    624,    468},
    {608,    452,    608,    452,    600,    452},
    {592,    436,    592,    436,    580,    436},
    {560,    420,    560,    420,    560,    420},
    {544,    408,    544,    408,    544,    408},
    {528,    392,    528,    392,    524,    392},
    {512,    380,    512,    380,    504,    380},
    {496,    368,    496,    368,    488,    368},
    {480,    356,    480,    356,    472,    356},
    {464,    340,    464,    340,    456,    340},
    {448,    332,    448,    332,    440,    332},
    {432,    320,    432,    320,    424,    320},
    {416,    308,    416,    308,    412,    308},
    {400,    296,    400,    296,    396,    296},
    {384,    288,    384,    288,    384,    288},
    {384,    276,    384,    276,    372,    276},
    {368,    268,    368,    268,    356,    268},
    {352,    260,    352,    260,    344,    260},
    {336,    252,    336,    252,    332,    252},
    {336,    240,    336,    240,    324,    240},
    {320,    232,    320,    232,    312,    232},
    {304,    224,    304,    224,    300,    224},
    {304,    216,    304,    216,    292,    216},
    {288,    212,    288,    212,    280,    212},
    {272,    204,    272,    204,    272,    204},
    {272,    196,    272,    196,    260,    196},
    {256,    188,    256,    188,    252,    188},
    {256,    184,    256,    184,    244,    184},
    {240,    176,    240,    176,    236,    176},
    {240,    172,    240,    172,    228,    172},
    {224,    164,    224,    164,    220,    164},
    {224,    160,    224,    160,    212,    160},
    {208,    156,    208,    156,    204,    156},
    {208,    148,    208,    148,    200,    148},
    {192,    144,    192,    144,    192,    144},
    {192,    140,    192,    140,    184,    140},
    {192,    136,    192,    136,    180,    136},
    {176,    128,    176,    128,    172,    128},
    {176,    124,    176,    124,    168,    124},
    {160,    120,    160,    120,    160,    120},
    {160,    116,    160,    116,    156,    116},
    {160,    112,    160,    112,    152,    112},
    {144,    108,    144,    108,    144,    108},
    {144,    104,    144,    104,    140,    104},
    {144,    100,    144,    100,    136,    100},
    {144,    100,    144,    100,    132,    100},
    {128,    96,     128,    96,     128,    96 },
    {128,    92,     128,    92,     124,    92 },
    {128,    88,     128,    88,     120,    88 },
};

const UINT32 VDOZOOM_INFOR_MODE_3_TABLE[61][6] =
{
    //sie_in        pre_out
    {1264,  948,  1264,  948,   1264,  948},
    {1232,  916,  1232,  916,   1220,  916},
    {1184,  884,  1184,  884,   1180,  884},
    {1152,  856,  1152,  856,   1140,  856},
    {1104,  824,  1104,  824,   1100,  824},
    {1072,  796,  1072,  796,   1064,  796},
    {1040,  772,  1040,  772,   1028,  772},
    {992,   744,  992,   744,   992,   744},
    {960,   720,  960,   720,   956,   720},
    {928,   692,  928,   692,   924,   692},
    {896,   672,  896,   672,   892,   672},
    {864,   648,  864,   648,   864,   648},
    {832,   624,  832,   624,   832,   624},
    {816,   604,  816,   604,   804,   604},
    {784,   584,  784,   584,   780,   584},
    {752,   564,  752,   564,   752,   564},
    {736,   544,  736,   544,   724,   544},
    {704,   524,  704,   524,   700,   524},
    {688,   508,  688,   508,   676,   508},
    {656,   492,  656,   492,   656,   492},
    {640,   476,  640,   476,   632,   476},
    {624,   456,  624,   456,   612,   456},
    {592,   444,  592,   444,   588,   444},
    {576,   428,  576,   428,   568,   428},
    {560,   412,  560,   412,   552,   412},
    {544,   400,  544,   400,   532,   400},
    {512,   384,  512,   384,   512,   384},
    {496,   372,  496,   372,   496,   372},
    {480,   360,  480,   360,   480,   360},
    {464,   348,  464,   348,   464,   348},
    {448,   336,  448,   336,   448,   336},
    {432,   324,  432,   324,   432,   324},
    {416,   312,  416,   312,   416,   312},
    {416,   304,  416,   304,   404,   304},
    {400,   292,  400,   292,   388,   292},
    {384,   280,  384,   280,   376,   280},
    {368,   272,  368,   272,   364,   272},
    {352,   264,  352,   264,   352,   264},
    {352,   256,  352,   256,   340,   256},
    {336,   244,  336,   244,   328,   244},
    {320,   236,  320,   236,   316,   236},
    {304,   228,  304,   228,   304,   228},
    {304,   220,  304,   220,   296,   220},
    {288,   212,  288,   212,   284,   212},
    {288,   208,  288,   208,   276,   208},
    {272,   200,  272,   200,   264,   200},
    {256,   192,  256,   192,   256,   192},
    {256,   184,  256,   184,   248,   184},
    {240,   180,  240,   180,   240,   180},
    {240,   172,  240,   172,   232,   172},
    {224,   168,  224,   168,   224,   168},
    {224,   160,  224,   160,   216,   160},
    {208,   156,  208,   156,   208,   156},
    {208,   152,  208,   152,   200,   152},
    {208,   144,  208,   144,   196,   144},
    {192,   140,  192,   140,   188,   140},
    {192,   136,  192,   136,   180,   136},
    {176,   132,  176,   132,   176,   132},
    {176,   128,  176,   128,   168,   128},
    {176,   124,  176,   124,   164,   124},
    {160,   120,  160,   120,   160,   120},
};

//full resolution
const UINT32 VDOZOOM_INFOR_MODE_4_TABLE[61][6] =
{
    //sie_in        pre_out
    {3376,  2532,  3376,  2532,  3376,  2532},
    {3264,  2444,  3264,  2444,  3260,  2444},
    {3152,  2364,  3152,  2364,  3148,  2364},
    {3056,  2280,  3056,  2280,  3044,  2280},
    {2944,  2204,  2944,  2204,  2940,  2204},
    {2848,  2128,  2848,  2128,  2840,  2128},
    {2752,  2056,  2752,  2056,  2744,  2056},
    {2656,  1988,  2656,  1988,  2648,  1988},
    {2560,  1920,  2560,  1920,  2560,  1920},
    {2480,  1852,  2480,  1852,  2472,  1852},
    {2400,  1792,  2400,  1792,  2388,  1792},
    {2304,  1728,  2304,  1728,  2304,  1728},
    {2240,  1672,  2240,  1672,  2228,  1672},
    {2160,  1612,  2160,  1612,  2152,  1612},
    {2080,  1560,  2080,  1560,  2080,  1560},
    {2016,  1504,  2016,  1504,  2008,  1504},
    {1952,  1456,  1952,  1456,  1940,  1456},
    {1872,  1404,  1872,  1404,  1872,  1404},
    {1808,  1356,  1808,  1356,  1808,  1356},
    {1760,  1312,  1760,  1312,  1748,  1312}, 
    {1696,  1268,  1696,  1268,  1688,  1268}, 
    {1632,  1224,  1632,  1224,  1632,  1224}, 
    {1584,  1180,  1584,  1180,  1576,  1180}, 
    {1520,  1140,  1520,  1140,  1520,  1140}, 
    {1472,  1104,  1472,  1104,  1468,  1104}, 
    {1424,  1064,  1424,  1064,  1420,  1064}, 
    {1376,  1028,  1376,  1028,  1372,  1028}, 
    {1328,  992 ,  1328,  992 ,  1324,  992 }, 
    {1280,  960 ,  1280,  960 ,  1280,  960 }, 
    {1248,  928 ,  1248,  928 ,  1236,  928 }, 
    {1200,  896 ,  1200,  896 ,  1192,  896 }, 
    {1152,  864 ,  1152,  864 ,  1152,  864 }, 
    {1120,  836 ,  1120,  836 ,  1112,  836 }, 
    {1088,  808 ,  1088,  808 ,  1076,  808 }, 
    {1040,  780 ,  1040,  780 ,  1040,  780 }, 
    {1008,  752 ,  1008,  752 ,  1004,  752 }, 
    {976 ,  728 ,  976 ,  728 ,  968 ,  728 }, 
    {944 ,  704 ,  944 ,  704 ,  936 ,  704 }, 
    {912 ,  680 ,  912 ,  680 ,  904 ,  680 }, 
    {880 ,  656 ,  880 ,  656 ,  872 ,  656 }, 
    {848 ,  632 ,  848 ,  632 ,  844 ,  632 }, 
    {816 ,  612 ,  816 ,  612 ,  816 ,  612 }, 
    {800 ,  592 ,  800 ,  592 ,  788 ,  592 }, 
    {768 ,  572 ,  768 ,  572 ,  760 ,  572 }, 
    {736 ,  552 ,  736 ,  552 ,  736 ,  552 }, 
    {720 ,  532 ,  720 ,  532 ,  708 ,  532 }, 
    {688 ,  516 ,  688 ,  516 ,  684 ,  516 }, 
    {672 ,  496 ,  672 ,  496 ,  664 ,  496 }, 
    {640 ,  480 ,  640 ,  480 ,  640 ,  480 }, 
    {624 ,  464 ,  624 ,  464 ,  616 ,  464 }, 
    {608 ,  448 ,  608 ,  448 ,  596 ,  448 }, 
    {576 ,  432 ,  576 ,  432 ,  576 ,  432 }, 
    {560 ,  416 ,  560 ,  416 ,  556 ,  416 }, 
    {544 ,  404 ,  544 ,  404 ,  536 ,  404 }, 
    {528 ,  388 ,  528 ,  388 ,  520 ,  388 }, 
    {512 ,  376 ,  512 ,  376 ,  500 ,  376 }, 
    {496 ,  364 ,  496 ,  364 ,  484 ,  364 }, 
    {480 ,  352 ,  480 ,  352 ,  468 ,  352 }, 
    {464 ,  340 ,  464 ,  340 ,  452 ,  340 }, 
    {448 ,  328 ,  448 ,  328 ,  436 ,  328 }, 
    {432 ,  316 ,  432 ,  316 ,  424 ,  316 }, 
};

UINT32 gDzoomTbl[61][6];
UINT32*  SenMode2Tbl(UINT32 SenMode,UINT32 *DzMaxidx)
{
    switch(SenMode)
    {
        //senmode,follow sensor driver,return corresponding dzoom tbl
        case SENSOR_MODE_640X480:
            memcpy(gDzoomTbl,VDOZOOM_INFOR_MODE_1_TABLE,sizeof(UINT32)*61*6);
            break;

        case SENSOR_MODE_960X720:
            memcpy(gDzoomTbl,VDOZOOM_INFOR_MODE_2_TABLE,sizeof(UINT32)*61*6);
            break;

        case SENSOR_MODE_1280X960:
            memcpy(gDzoomTbl,VDOZOOM_INFOR_MODE_3_TABLE,sizeof(UINT32)*61*6);
            break;

        case SENSOR_MODE_FULL:
            memcpy(gDzoomTbl,VDOZOOM_INFOR_MODE_4_TABLE,sizeof(UINT32)*61*6);
            break;
            
        default:
            debug_err(("%d %s\r\n",__LINE__,__func__));
        break;
    }
    *DzMaxidx = (61 -1+10);
    return gDzoomTbl[0];
}
#endif
